// Generated by CoffeeScript 1.3.3
(function() {
  var Neat, basename, describe, ensureSync, error, exists, extname, missing, namespace, neatBroken, project, puts, render, resolve, touchSync, usages, warn, _ref, _ref1, _ref2, _ref3,
    __slice = [].slice;

  _ref = require('path'), resolve = _ref.resolve, exists = _ref.existsSync, basename = _ref.basename, extname = _ref.extname;

  Neat = require('../neat');

  _ref1 = require(resolve(Neat.neatRoot, "lib/utils/logs")), puts = _ref1.puts, error = _ref1.error, warn = _ref1.warn, missing = _ref1.missing, neatBroken = _ref1.neatBroken;

  _ref2 = require(resolve(Neat.neatRoot, "lib/utils/files")), ensureSync = _ref2.ensureSync, touchSync = _ref2.touchSync;

  namespace = require(resolve(Neat.neatRoot, "lib/utils/exports")).namespace;

  render = require(resolve(Neat.neatRoot, "lib/utils/templates")).renderSync;

  _ref3 = require(resolve(Neat.neatRoot, "lib/utils/commands")), usages = _ref3.usages, describe = _ref3.describe;

  usages('neat generate project [name]', describe('Creates a [name] directory with the default neat project content', project = function() {
    var args, base, cakefile, callback, ext, generator, gitignore, name, neatfile, nemfile, npmignore, path, tplpath, _i;
    generator = arguments[0], name = arguments[1], args = 4 <= arguments.length ? __slice.call(arguments, 2, _i = arguments.length - 1) : (_i = 2, []), callback = arguments[_i++];
    if (name == null) {
      return error("Missing name argument");
    }
    path = resolve('.', name);
    base = basename(__filename);
    ext = extname(__filename);
    tplpath = resolve(__dirname, "project");
    gitignore = resolve(path, ".gitignore");
    npmignore = resolve(path, ".npmignore");
    neatfile = resolve(path, ".neat");
    nemfile = resolve(path, "Nemfile");
    cakefile = resolve(path, "Cakefile");
    ensureSync(path);
    try {
      touchSync(gitignore, render(resolve(tplpath, ".gitignore")));
      touchSync(npmignore, render(resolve(tplpath, ".npmignore")));
      touchSync(neatfile, render(resolve(tplpath, ".neat"), {
        name: name
      }));
      touchSync(nemfile, render(resolve(tplpath, "Nemfile")));
      touchSync(cakefile, render(resolve(tplpath, "Cakefile")));
      ensureSync(resolve(path, "lib"));
      ensureSync(resolve(path, "src"));
      ensureSync(resolve(path, "src/commands"));
      ensureSync(resolve(path, "src/generators"));
      ensureSync(resolve(path, "src/config"));
      ensureSync(resolve(path, "src/config/environments"));
      ensureSync(resolve(path, "src/config/initializers"));
      ensureSync(resolve(path, "templates"));
      ensureSync(resolve(path, "test"));
      ensureSync(resolve(path, "test/fixtures"));
      ensureSync(resolve(path, "test/spec"));
      touchSync(resolve(path, "lib/.gitkeep"));
      touchSync(resolve(path, "src/commands/.gitkeep"));
      touchSync(resolve(path, "src/generators/.gitkeep"));
      touchSync(resolve(path, "src/config/environments/.gitkeep"));
      touchSync(resolve(path, "src/config/initializers/.gitkeep"));
      touchSync(resolve(path, "templates/.gitkeep"));
      touchSync(resolve(path, "test/.gitkeep"));
      touchSync(resolve(path, "test/fixtures/.gitkeep"));
      touchSync(resolve(path, "test/spec/.gitkeep"));
    } catch (e) {
      return error("Cannot proceed to the generation of the project\n\n" + e.stack);
    }
    return typeof callback === "function" ? callback() : void 0;
  }));

  module.exports = {
    project: project
  };

}).call(this);
