<!DOCTYPE html>  <html> <head>   <title>object.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="array.html">                 array.coffee               </a>                                           <a class="source" href="index.html">                 index.coffee               </a>                                           <a class="source" href="mixin.html">                 mixin.coffee               </a>                                           <a class="source" href="module.html">                 module.coffee               </a>                                           <a class="source" href="number.html">                 number.coffee               </a>                                           <a class="source" href="object.html">                 object.coffee               </a>                                           <a class="source" href="string.html">                 string.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               object.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>This file contains Object's extensions that mimics some of the ruby
Object and Hash methods.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h3>Helpers</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Defines a non-enumerable property on <code>Object.prototype</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">def </span><span class="o">=</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">for</span> <span class="nx">name</span><span class="p">,</span><span class="nx">value</span> <span class="k">of</span> <span class="nx">o</span>
    <span class="k">unless</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span><span class="o">?</span>
      <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="o">?</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
                             <span class="nx">name</span><span class="p">,</span>
                             <span class="py">enumerable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="py">value</span><span class="o">:</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h3>Object Class Extensions</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h4>Object.new</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Creates a new object from an array such as <code>[key, value, key, value, ...]</code>.</p>

<pre><code>o = Object.new ['foo', 10, 'bar', 20, 'baz', 30]
# {foo: 10, bar: 20, baz: 30}
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Object</span><span class="p">.</span><span class="k">new</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">o </span><span class="o">=</span> <span class="p">{};</span> <span class="nx">a</span><span class="p">.</span><span class="nx">step</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">);</span> <span class="k">return</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h3>Object Instances Extensions</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h4>Object::contains</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p><code>Object::has</code> alias.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">contains</span><span class="o">:</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@has</span> <span class="nx">value</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h4>Object::flatten</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Returns an array such as <code>[key, value, key, value]</code> with the name
and the content of the enumerable properties of this object.</p>

<pre><code>{foo: 10, bar: 20, baz: 30}.flatten()
# ['foo', 10, 'bar', 20, 'baz', 30]
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">flatten</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="nv">a </span><span class="o">=</span> <span class="p">[];</span> <span class="nv">a </span><span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">concat</span> <span class="p">[</span><span class="nx">k</span><span class="p">,</span><span class="nx">v</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="py">this</span><span class="p">;</span> <span class="k">return</span> <span class="nx">a</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h4>Object::has</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Retuns <code>true</code> if the specified values is contained in one of the object
enumerable properties.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">has</span><span class="o">:</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">value</span> <span class="k">in</span> <span class="py">@values</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h4>Object::hasKey</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Returns <code>true</code> if the specified key is defined on this object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">hasKey</span><span class="o">:</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="o">?</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h4>Object::keys</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Returns an array of the keys enumerable on this object.</p>

<p>The keys are returned as the <code>for..in</code> construct iterates on them.
Use <code>sortedKeys</code> to retreive the keys sorted alphabetically.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">keys</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="nx">k</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">of</span> <span class="py">this</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h4>Object::length</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Returns the count of enumerable properties on this object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">length</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="py">@keys</span><span class="p">().</span><span class="nx">length</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h4>Object::merge</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Merge the enumerable properties of <code>o</code> into this object.</p>

<p>A target object property is overriden by the source property
if both hold the same property.</p>

<pre><code>target = foo: 10
target.merge bar: 20, baz: 30
# target = {foo: 10, bar: 20, baz: 30}
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">merge</span><span class="o">:</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h4>Object::reject</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Returns an object without the properties that are evaluated as <code>true</code>
in the passed-in filter function.</p>

<pre><code>source = foo: 10, bar: 20, baz: 30
target = source.reject (k,v) -&gt; v &gt; 10
# target = {foo: 10}
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">reject</span><span class="o">:</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">o </span><span class="o">=</span> <span class="p">{};</span> <span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="py">this</span> <span class="k">when</span> <span class="o">not</span> <span class="nx">f</span><span class="o">?</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">;</span> <span class="k">return</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <h4>Object::select</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Returns an object with the properties that are evaluated as <code>true</code>
in the passed-in filter function.</p>

<pre><code>source = foo: 10, bar: 20, baz: 30
target = source.select (k,v) -&gt; v &gt; 10
# target = {bar: 20, baz: 30}
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">select</span><span class="o">:</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">o </span><span class="o">=</span> <span class="p">{};</span> <span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="py">this</span> <span class="k">when</span> <span class="nx">f</span><span class="o">?</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">;</span> <span class="k">return</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h4>Object::size</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p><code>Object::length</code> alias.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">size</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="py">@length</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <h4>Object::sortedKeys</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Returns the enumerable keys sorted alphabetically.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">sortedKeys</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="py">@keys</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <h4>Object::sortedValues</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Returns the values of the enumerable properties of this object.
The values are ordered such as each key in <code>sortedKeys</code> correspond
to the value at the same index in <code>sortedValues</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">sortedValues</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="py">@</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="py">@sortedKeys</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <h4>Object::type</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Returns the results of calling <code>Object::toString</code> on the current object
and extracting the class name to lower case.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">type</span><span class="o">:</span> <span class="o">-&gt;</span>
  <span class="nb">Object</span><span class="o">::</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="py">@</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">replace</span> <span class="sr">/\[object </span><span class="sro">(</span><span class="sre">\w</span><span class="sro">+)</span><span class="sr">\]/</span><span class="p">,</span> <span class="s">&quot;$1&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h4>Object::update</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p><code>Object::merge</code> alias.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">update</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="py">@merge</span> <span class="nx">o</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <h4>Object::values</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Returns the values of the enumerable properties of this object.
The values are returned as the <code>for..in</code> construct iterates on this object.
Use <code>sortedValues</code> to retreive the values based on the alphabetically
sorted keys.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">values</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="py">@</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="py">@keys</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h3>Duck Typing</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <h4>Object::quacksLike</h4>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>The <code>Object::quacksLike</code> method allow to perform a duck test
on the current object object.</p>

<p>Duck tests are performed by looking for a special <code>__definition__</code> field
on the passed-in <code>type</code> object. This field can either contains a function
or an structure object.</p>

<p>When using a structure object, the keys matched for properties name and
values can be either a string that will be tested against <code>typeof value</code>
(use <code>*</code> to allow any type) or a function that will be called with the
value as argument.</p>

<p>Below an example of how <code>quacksLike</code> can be used with custom
type definitions:</p>

<pre><code>Point =
  __definition__:
    x: 'number'
    y: 'number'

class ConcretPoint
  constructor: (@x=0, @y=0) -&gt;

point = new ConcretPoint
point.quacksLike Point  # true

point.x = "foo"
point.quacksLike Point  # false

object = {x: 10, y: 20}
object.quacksLike Point # true
</code></pre>

<p>An example demonstrating the use of function as definition:</p>

<pre><code>Command =
  __definition__: (o) -&gt;
    typeof o is "function" and o.aliases?

command = -&gt; # do something
command.aliases = ['c', 'command']

command.quacksLike Command # true
</code></pre>

<p>Of course, a class can describe itself in its body:</p>

<pre><code>class Point
  @__definition__:
    x: 'number'
    y: 'number'

  constructor: (@x, @y) -&gt;
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">def</span> <span class="py">quacksLike</span><span class="o">:</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">type</span><span class="p">.</span><span class="nb">__definition__</span><span class="o">?</span>
    <span class="nv">definition </span><span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nb">__definition__</span>
    <span class="k">return</span> <span class="nx">definition</span> <span class="py">this</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">definition</span> <span class="o">is</span> <span class="s">&quot;function&quot;</span>
    <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="nx">definition</span>
      <span class="k">switch</span> <span class="k">typeof</span> <span class="nx">v</span>
        <span class="k">when</span> <span class="s">&quot;function&quot;</span> <span class="k">then</span> <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="nx">v</span> <span class="py">@</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span>
        <span class="k">else</span> <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="p">(</span><span class="nx">v</span> <span class="o">is</span> <span class="s">&quot;*&quot;</span> <span class="o">or</span> <span class="py">@</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">type</span><span class="p">()</span> <span class="o">is</span> <span class="nx">v</span><span class="p">)</span>
    <span class="kc">true</span>
  <span class="k">else</span>
    <span class="kc">false</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 