
<html>
  <meta charset='utf-8'>
  <title>src/utils/commands.coffee</title>
  <head>
    <link rel='stylesheet' media='all' href='docco.css'>
<link href='http://fonts.googleapis.com/css?family=Lato:300' rel='stylesheet' type='text/css'>
<script src='http://code.jquery.com/jquery-1.6.2.min.js' type='text/javascript' charset='utf-8'></script>
<script src='docco.js' type='text/javascript' charset='utf-8'></script>
    <script>
      $(document).ready(function(){
        $('#menu').columnview();
        $('#jump_show').click(function(){
          $('#jump_to').toggleClass('visible')
        })
        var p = "src/utils/commands.coffee".split('/')
        var f = p.pop()
        for(var i=0;i<p.length;i++){
          var s = p[i] + "/"
          $("#jump_page div a span.label").filter(function(){
            return $(this).text() == s
          }).parent().click()
        }
    
        $("#jump_page div a span.label").filter(function(){
          return $(this).text() == f
        }).last().parent().toggleClass('active')
      })
    </script>
  </head>
  <body>
    <div id='container'>
      <div id='jump_to'><div id='jump_page'>
  <ul class='menu' id='menu'>
    <li class='leaf'><a href='#'>src/</a><ul class='menu'><li class='leaf'><a href='src_neat.html'>neat.coffee</a></li><li class='leaf'><a href='src_env.html'>env.coffee</a></li><li class='leaf'><a href='src_index.html'>index.coffee</a></li><li class='leaf'><a href='#'>async/</a><ul class='menu'><li class='leaf'><a href='src_async_index.html'>index.coffee</a></li></ul></li><li class='leaf'><a href='#'>core/</a><ul class='menu'><li class='leaf'><a href='src_core_index.html'>index.coffee</a></li><li class='leaf'><a href='#'>interfaces/</a><ul class='menu'><li class='leaf'><a href='src_core_interfaces_cli_command.html'>cli_command.coffee</a></li></ul></li><li class='leaf'><a href='src_core_mixin.html'>mixin.coffee</a></li><li class='leaf'><a href='src_core_module.html'>module.coffee</a></li><li class='leaf'><a href='src_core_signal.html'>signal.coffee</a></li><li class='leaf'><a href='#'>types/</a><ul class='menu'><li class='leaf'><a href='src_core_types_array.html'>array.coffee</a></li><li class='leaf'><a href='src_core_types_index.html'>index.coffee</a></li><li class='leaf'><a href='src_core_types_number.html'>number.coffee</a></li><li class='leaf'><a href='src_core_types_object.html'>object.coffee</a></li><li class='leaf'><a href='src_core_types_string.html'>string.coffee</a></li><li class='leaf'><a href='src_core_types_utils.html'>utils.coffee</a></li></ul></li></ul></li><li class='leaf'><a href='#'>i18n/</a><ul class='menu'><li class='leaf'><a href='src_i18n_i18n.html'>i18n.coffee</a></li><li class='leaf'><a href='src_i18n_index.html'>index.coffee</a></li></ul></li><li class='leaf'><a href='#'>utils/</a><ul class='menu'><li class='leaf'><a href='src_utils_commands.html'>commands.coffee</a></li><li class='leaf'><a href='src_utils_cup.html'>cup.coffee</a></li><li class='leaf'><a href='src_utils_exports.html'>exports.coffee</a></li><li class='leaf'><a href='src_utils_files.html'>files.coffee</a></li><li class='leaf'><a href='src_utils_generators.html'>generators.coffee</a></li><li class='leaf'><a href='src_utils_index.html'>index.coffee</a></li><li class='leaf'><a href='#'>logs/</a><ul class='menu'><li class='leaf'><a href='src_utils_logs_index.html'>index.coffee</a></li><li class='leaf'><a href='src_utils_logs_logger.html'>logger.coffee</a></li></ul></li><li class='leaf'><a href='src_utils_mappers.html'>mappers.coffee</a></li><li class='leaf'><a href='src_utils_matchers.html'>matchers.coffee</a></li><li class='leaf'><a href='src_utils_templates.html'>templates.coffee</a></li></ul></li></ul></li>
  </ul>
</div>
<div id='jump_show'>
  Jump To &hellip;
</div></div>
      <table cellpadding='0' cellspacing='0'>
        <tr>
          <th class='docs'>
            <h3>src/utils/</h3>
            <h1>commands.coffee</h1>
          </th>
          <th class='code'>
            <pre></pre>
          </th>
        </tr>
        <tr>
          <td class='docs'><p>This file contains utilities to setup commands and generators.
<h3>Table Of Content</h3>
<ul class='toc'>
  <li class='level0'>
    <a href='#private'>Private</a>
  </li>
  <li class='level1'>
    <a href='#decorate'>decorate</a>
  </li>
  <li class='level0'>
    <a href='#public'>Public</a>
  </li>
  <li class='level1'>
    <a href='#aliases'>aliases</a>
  </li>
  <li class='level1'>
    <a href='#asyncerrortrap'>asyncErrorTrap</a>
  </li>
  <li class='level1'>
    <a href='#describe'>describe</a>
  </li>
  <li class='level1'>
    <a href='#environment'>environment</a>
  </li>
  <li class='level1'>
    <a href='#hasharguments'>hashArguments</a>
  </li>
  <li class='level1'>
    <a href='#help'>help</a>
  </li>
  <li class='level1'>
    <a href='#neattask'>neatTask</a>
  </li>
  <li class='level1'>
    <a href='#run'>run</a>
  </li>
  <li class='level1'>
    <a href='#usages'>usages</a>
  </li>
</ul></p></td>
          <td class='code'><div class="highlight"><pre><span class="p">{</span><span class="nx">spawn</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;child_process&#39;</span>
<span class="p">{</span><span class="nx">resolve</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;path&#39;</span>
<span class="p">{</span><span class="nx">puts</span><span class="p">,</span> <span class="nx">print</span><span class="p">,</span> <span class="nx">error</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;./logs&#39;</span>
<span class="nb">Neat</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;../neat&#39;</span>
<span class="nv">_ </span><span class="o">=</span> <span class="nb">Neat</span><span class="p">.</span><span class="nx">i18n</span><span class="p">.</span><span class="nx">getHelper</span><span class="p">()</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h3 id='private'>Private</h3></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='decorate'>decorate</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Decorates an object with the specified property and value.</p></td>
          <td class='code'><div class="highlight"><pre><span class="nv">decorate </span><span class="o">=</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">target</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
  <span class="nx">target</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h3 id='public'>Public</h3></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='aliases'>aliases</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Defines the aliases of the <code>target</code>. Aliases are used to defined
the keywords for which the command respond.</p>

<div class="highlight"><pre><span class="nx">aliases</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;command was called&#39;</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">aliases </span><span class="o">=</span> <span class="p">(</span><span class="nx">aliases</span><span class="p">...,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">decorate</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&#39;aliases&#39;</span><span class="p">,</span> <span class="nx">aliases</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='asyncerrortrap'>asyncErrorTrap</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Trap error returned by asynchronous function in the callback arguments
by generating a callback wrapper that will call the callback only if
no errors was received. The error argument is not passed to the callback.</p>

<div class="highlight"><pre><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="s">&quot;/path/to/file&quot;</span><span class="p">,</span> <span class="nx">asyncErrorTrap</span> <span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># do something with content</span>
</pre></div>

<p>Optionally, a function can be passed as first argument to receive the error,
typically the final callback you'll trigger in your async process.</p>

<div class="highlight"><pre><span class="nv">asyncFunction </span><span class="o">=</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">path </span><span class="o">=</span> <span class="s">&quot;/path/to/file&quot;</span>
  <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">asyncErrorTrap</span> <span class="nx">callback</span><span class="p">,</span> <span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># do something with content</span>
    <span class="nx">callback</span><span class="o">?</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">content</span>
</pre></div>

<p>If an error occurs, the callback is automatically triggered with the error
as the first argument, following in that regard the pattern of node's async
functions. You should take care to pass your results after a null argument,
allowing callback to use the following pattern:</p>

<div class="highlight"><pre><span class="nx">asyncFunction</span> <span class="nx">asyncErrorTrap</span> <span class="p">(</span><span class="nx">results</span><span class="p">...)</span> <span class="o">-&gt;</span> <span class="c1"># etc...</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">asyncErrorTrap </span><span class="o">=</span> <span class="p">(</span><span class="nx">errCallback</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">args</span><span class="p">...)</span> <span class="o">-&gt;</span>
  <span class="p">[</span><span class="nx">errCallback</span><span class="p">,</span> <span class="nx">callback</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">errCallback</span><span class="p">]</span> <span class="k">unless</span> <span class="nx">callback</span><span class="o">?</span>
  <span class="k">if</span> <span class="nx">err</span><span class="o">?</span>
    <span class="k">if</span> <span class="nx">errCallback</span><span class="o">?</span> <span class="k">then</span> <span class="k">return</span> <span class="nx">errCallback</span> <span class="nx">err</span> <span class="k">else</span> <span class="k">return</span> <span class="nx">err</span>
  <span class="nx">callback</span><span class="o">?</span><span class="p">.</span><span class="nx">apply</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">args</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='describe'>describe</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Defines the description of the <code>target</code>.</p>

<div class="highlight"><pre><span class="nx">describe</span> <span class="s">&#39;This is a description&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;command was called&#39;</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">describe </span><span class="o">=</span> <span class="p">(</span><span class="nx">description</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">decorate</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&#39;description&#39;</span><span class="p">,</span> <span class="nx">description</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='environment'>environment</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Loads automatically the specified environment before triggering
the <code>target</code>.</p>

<div class="highlight"><pre><span class="nx">environment</span> <span class="s">&#39;test&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nb">Neat</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">test</span><span class="o">?</span> <span class="c1"># true</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">environment </span><span class="o">=</span> <span class="p">(</span><span class="nx">env</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">decorate</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&#39;environment&#39;</span><span class="p">,</span> <span class="nx">env</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='hasharguments'>hashArguments</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Converts an array of strings with a form such as <code>key:value</code>
in an object with the corresponding properties.</p>

<p>These are supposed to come from a command line input such as
some limitations occurs:</p>

<ol>
<li>There cannot be any spaces between the key, the colon and the value.</li>
<li>String values that will contains spaces must be wrapped into <code>"</code> or <code>'</code>.</li>
<li>There cannot be any spaces between the element of an array and the
 commas before and after it.</li>
</ol>

<p>For instance, in the following command line input:</p>

<div class="highlight"><pre><span class="nx">neat</span> <span class="nx">g</span> <span class="nx">project</span> <span class="nx">dummy</span> <span class="py">author</span><span class="o">:</span><span class="s">&quot;John Doe&quot;</span> <span class="py">keywords</span><span class="o">:</span><span class="nx">foo</span><span class="p">,</span><span class="nx">bar</span>
</pre></div>

<p>The hash arguments, once parsed by the <code>hashArguments</code> function,
will look like:</p>

<div class="highlight"><pre><span class="p">{</span><span class="py">author</span><span class="o">:</span> <span class="s">&#39;John Doe&#39;</span><span class="p">,</span> <span class="py">keywords</span><span class="o">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">]}</span>
</pre></div>

<p>Basic types such <code>String</code>, <code>Number</code>, <code>Boolean</code> and <code>Array</code> are supported
as arguments value:</p>

<div class="highlight"><pre><span class="py">integer</span><span class="o">:</span><span class="mi">0</span>                  <span class="c1"># 0</span>
<span class="py">float</span><span class="o">:</span><span class="mf">0.5</span>                  <span class="c1"># 0.5</span>
<span class="py">string</span><span class="o">:</span><span class="nx">foo</span>                 <span class="c1"># &#39;foo&#39;</span>
<span class="py">stringWithSpace</span><span class="o">:</span><span class="s">&quot;foo bar&quot;</span>  <span class="c1"># &#39;foo bar&#39;</span>
<span class="py">booleans</span><span class="o">:</span><span class="kc">yes</span>               <span class="c1"># true</span>
<span class="py">arrays</span><span class="o">:</span><span class="nx">foo</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="kc">false</span>        <span class="c1"># [&#39;foo&#39;, 10, false]</span>
</pre></div>

<p>As you may have notice, booleans are available with various aliases:</p>

<ul>
<li><code>true</code>: <code>true</code>, <code>on</code>, <code>yes</code></li>
<li><code>false</code>: <code>false</code>, <code>off</code>, <code>no</code></li>
</ul></td>
          <td class='code'><div class="highlight"><pre><span class="nv">hashArguments </span><span class="o">=</span> <span class="p">(</span><span class="nx">ary</span><span class="p">...)</span> <span class="o">-&gt;</span>
  <span class="nv">ary </span><span class="o">=</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">flatten</span><span class="p">()</span>
  <span class="nv">hash </span><span class="o">=</span> <span class="p">{}</span>
  <span class="nv">parse </span><span class="o">=</span> <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="k">switch</span> <span class="kc">true</span>
      <span class="k">when</span> <span class="sr">/</span><span class="sro">^(</span><span class="sr">false|no|off</span><span class="sro">)$</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span> <span class="nx">v</span> <span class="k">then</span> <span class="kc">false</span>
      <span class="k">when</span> <span class="sr">/</span><span class="sro">^(</span><span class="sr">true|yes|on</span><span class="sro">)$</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span> <span class="nx">v</span> <span class="k">then</span> <span class="kc">true</span>
      <span class="k">when</span> <span class="sr">/</span><span class="sro">^(</span><span class="sr">-</span><span class="sro">*)</span><span class="sre">\d</span><span class="sro">+$</span><span class="sr">/g</span><span class="p">.</span><span class="nx">test</span> <span class="nx">v</span> <span class="k">then</span> <span class="nb">parseInt</span> <span class="nx">v</span>
      <span class="k">when</span> <span class="sr">/</span><span class="sro">^(</span><span class="sr">-</span><span class="sro">*)</span><span class="sre">\d</span><span class="sro">+</span><span class="sr">\.\d</span><span class="sro">+$</span><span class="sr">/g</span><span class="p">.</span><span class="nx">test</span> <span class="nx">v</span> <span class="k">then</span> <span class="nb">parseFloat</span> <span class="nx">v</span>
      <span class="k">when</span> <span class="s">&#39;,&#39;</span> <span class="k">in</span> <span class="nb">String</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="k">then</span> <span class="nx">parse</span> <span class="nx">sub</span> <span class="k">for</span> <span class="nx">sub</span> <span class="k">in</span> <span class="nx">v</span><span class="p">.</span><span class="nx">split</span> <span class="s">&#39;,&#39;</span>
      <span class="k">else</span> <span class="nx">v</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/</span><span class="sro">^(</span><span class="sr">&#39;|&quot;</span><span class="sro">)|(</span><span class="sr">&#39;|&quot;</span><span class="sro">)$</span><span class="sr">/g</span><span class="p">,</span> <span class="s">&#39;&#39;</span>

  <span class="k">for</span> <span class="nx">expr</span> <span class="k">in</span> <span class="nx">ary</span>
    <span class="p">(</span><span class="nx">hash</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="k">continue</span><span class="p">)</span> <span class="k">unless</span> <span class="s">&#39;:&#39;</span> <span class="k">in</span> <span class="nx">expr</span>
    <span class="p">[</span><span class="nx">k</span><span class="p">,</span><span class="nx">v</span><span class="p">]</span> <span class="o">=</span> <span class="nx">expr</span><span class="p">.</span><span class="nx">split</span> <span class="s">&#39;:&#39;</span>
    <span class="k">if</span> <span class="nx">v</span><span class="p">.</span><span class="nx">empty</span><span class="p">()</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="nx">_</span><span class="p">(</span><span class="s">&#39;neat.commands.invalid_arguments&#39;</span><span class="p">,</span> <span class="py">expression</span><span class="o">:</span> <span class="nx">expr</span><span class="p">)</span>

    <span class="nx">hash</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parse</span> <span class="nx">v</span>

  <span class="nx">hash</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='help'>help</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Defines the help of the <code>target</code>.</p>

<div class="highlight"><pre><span class="nx">help</span> <span class="s">&#39;This is the help&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;command was called&#39;</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">help </span><span class="o">=</span> <span class="p">(</span><span class="nx">help</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">decorate</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&#39;help&#39;</span><span class="p">,</span> <span class="nx">help</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='neattask'>neatTask</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Register a cake task that will run through Neat.</p>

<div class="highlight"><pre><span class="nv">exports.taskName </span><span class="o">=</span> <span class="nx">neatTask</span>
  <span class="py">name</span><span class="o">:</span> <span class="s">&#39;taskName&#39;</span>                <span class="c1"># required</span>
  <span class="py">description</span><span class="o">:</span> <span class="s">&#39;task description&#39;</span> <span class="c1"># optional</span>
  <span class="py">environment</span><span class="o">:</span> <span class="s">&#39;production&#39;</span>       <span class="c1"># optional</span>
  <span class="py">action</span><span class="o">:</span> <span class="o">-&gt;</span> <span class="p">...</span>                  <span class="c1"># required</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">neatTask </span><span class="o">=</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="p">{</span><span class="nx">name</span><span class="p">,</span> <span class="nx">action</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">environment</span><span class="p">}</span> <span class="o">=</span> <span class="nx">options</span>

  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="nx">_</span><span class="p">(</span><span class="s">&#39;neat.tasks.no_name&#39;</span><span class="p">)</span> <span class="k">unless</span> <span class="nx">name</span><span class="o">?</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span> <span class="nx">_</span><span class="p">(</span><span class="s">&#39;neat.tasks.no_action&#39;</span><span class="p">)</span> <span class="k">unless</span> <span class="nx">action</span><span class="o">?</span>

  <span class="nv">action.environment </span><span class="o">=</span> <span class="nx">environment</span>
  <span class="nv">action.description </span><span class="o">=</span> <span class="nx">description</span>

  <span class="nv">taskAction </span><span class="o">=</span> <span class="o">-&gt;</span>
    <span class="p">{</span><span class="nx">action</span><span class="p">,</span> <span class="nx">environment</span><span class="p">}</span> <span class="o">=</span> <span class="nx">options</span>
    <span class="nb">Neat</span><span class="p">.</span><span class="nv">defaultEnvironment </span><span class="o">=</span> <span class="nx">environment</span> <span class="k">if</span> <span class="nx">environment</span><span class="o">?</span>
    <span class="nb">Neat</span><span class="p">.</span><span class="nx">initEnvironment</span> <span class="o">-&gt;</span>
      <span class="nb">Neat</span><span class="p">.</span><span class="nx">beforeTask</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">-&gt;</span> <span class="nx">action</span> <span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="o">-&gt;</span>
        <span class="nb">Neat</span><span class="p">.</span><span class="nx">afterTask</span><span class="p">.</span><span class="nx">dispatch</span> <span class="nx">status</span>

  <span class="nx">task</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">taskAction</span>
  <span class="nx">action</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='run'>run</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Runs the specified <code>command</code> with the passed-in <code>params</code>.
The <code>callback</code> is called on the command exit if provided.</p>

<div class="highlight"><pre><span class="nx">run</span> <span class="s">&#39;coffee&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;-pcb&#39;</span><span class="p">,</span> <span class="s">&#39;console.log &quot;foo&quot;&#39;</span><span class="p">],</span> <span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;command exited with status </span><span class="si">#{</span><span class="nx">status</span><span class="si">}</span><span class="s">&quot;</span>
</pre></div>

<p>You can also prevent the function to print the command output
or register your own output listeners using the <code>options</code> hash.</p>

<div class="highlight"><pre><span class="nv">options </span><span class="o">=</span>
  <span class="py">noStdout</span><span class="o">:</span> <span class="kc">true</span>
  <span class="py">stdError</span><span class="o">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="c1"># Do something with data</span>

<span class="nx">run</span> <span class="s">&#39;coffee&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;src/*&#39;</span><span class="p">],</span> <span class="nx">options</span><span class="p">,</span> <span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;command exited with status </span><span class="si">#{</span><span class="nx">status</span><span class="si">}</span><span class="s">&quot;</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">run </span><span class="o">=</span> <span class="p">(</span><span class="nx">command</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="p">[</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">options</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">options</span><span class="p">,</span> <span class="nx">callback</span><span class="p">]</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">options</span> <span class="o">is</span> <span class="s">&#39;function&#39;</span>

  <span class="nv">exe </span><span class="o">=</span> <span class="nx">spawn</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">params</span>

  <span class="k">unless</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">noStdout</span><span class="o">?</span>
    <span class="nx">exe</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="kc">on</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">stdout</span> <span class="o">||</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">print</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
  <span class="k">unless</span> <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">noStderr</span><span class="o">?</span>
    <span class="nx">exe</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="kc">on</span> <span class="s">&#39;data&#39;</span><span class="p">,</span>  <span class="nx">options</span><span class="o">?</span><span class="p">.</span><span class="nx">stderr</span> <span class="o">||</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">print</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>

  <span class="nx">exe</span><span class="p">.</span><span class="kc">on</span> <span class="s">&#39;exit&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">callback</span><span class="o">?</span> <span class="nx">status</span></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><h4 id='usages'>usages</h4></td>
          <td class='code'><div class="highlight"><pre></pre></div></td>
        </tr>
        <tr>
          <td class='docs'><p>Defines the usages of the <code>target</code>.</p>

<div class="highlight"><pre><span class="nx">usages</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo [arg]&#39;</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;command called&#39;</span>
</pre></div></td>
          <td class='code'><div class="highlight"><pre><span class="nv">usages </span><span class="o">=</span> <span class="p">(</span><span class="nx">usages</span><span class="p">...,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">decorate</span> <span class="nx">target</span><span class="p">,</span> <span class="s">&#39;usages&#39;</span><span class="p">,</span> <span class="nx">usages</span>

<span class="nv">module.exports </span><span class="o">=</span> <span class="p">{</span>
  <span class="nx">aliases</span><span class="p">,</span>
  <span class="nx">asyncErrorTrap</span><span class="p">,</span>
  <span class="nx">decorate</span><span class="p">,</span>
  <span class="nx">describe</span><span class="p">,</span>
  <span class="nx">environment</span><span class="p">,</span>
  <span class="nx">hashArguments</span><span class="p">,</span>
  <span class="nx">help</span><span class="p">,</span>
  <span class="nx">neatTask</span><span class="p">,</span>
  <span class="nx">run</span><span class="p">,</span>
  <span class="nx">usages</span><span class="p">,</span>
<span class="p">}</span>

</pre></div></td>
        </tr>
      </table>
    </div>
  </body>
</html>